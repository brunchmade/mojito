language: objective-c
osx_image: xcode7.2
cache:
    - cocoapods
before_install:
    # install dmg building tool
    - "pip install dmgbuild"
    # upgrade xctool
    - "brew update"
    - "if brew outdated | grep -qx xctool; then brew upgrade xctool; fi"
    - "carthage bootstrap --platform Mac"
script: >
    xctool
    -project Mojito.xcodeproj
    -scheme Mojito
    build test

deploy:
  provider: script
  script: scripts/deploy.sh
  on:
    branch: build-dmg
